---
layout: single

header:
  teaser: /assets/images/logo/spring.png
  overlay_image: /assets/images/logo/spring.png
  overlay_filter: linear-gradient(rgba(255, 0, 0, 0.5), rgba(0, 255, 255, 0.5))
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
  actions:
    - label: "Github"
      url: "https://github.com/renine94"

title: "[spring] ìŠ¤í”„ë§ JPA ê°ì²´ì§€í–¥ ì¿¼ë¦¬ì–¸ì–´ JPQL - ì†Œê°œ"
excerpt: "ğŸš€ spring, JPA, JPQL, ê°ì²´ì§€í–¥ ì¿¼ë¦¬ì–¸ì–´"

categories: spring
tag: [spring, model, jpa, jpql]

toc: true
toc_label: "ğŸ“• ëª©ì°¨"
toc_icon: "null"
toc_sticky: true

sidebar:
  nav: "docs"


---

# ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´1 - ê¸°ë³¸ ë¬¸ë²• : ì†Œê°œ

- **ì†Œê°œ**
- ê¸°ë³¸ ë¬¸ë²•ê³¼ ì¿¼ë¦¬API
- í”„ë¡œì ì…˜(SELECT)
- í˜ì´ì§•
- ì¡°ì¸
- ì„œë¸Œ ì¿¼ë¦¬
- JPQL íƒ€ì… í‘œí˜„ê³¼ ê¸°íƒ€ì‹
- ì¡°ê±´ì‹(CASE ë“±ë“±)
- JPQL í•¨ìˆ˜

<br><br>

## TL; DR

> ìµœê·¼ ì‹¤ë¬´ì—ì„œëŠ” JPQL, QueryDSL ì„ ì“´ë‹¤.





## 01. JPAëŠ” ë‹¤ì–‘í•œ ì¿¼ë¦¬ ë°©ë²•ì„ ì§€ì›

- **JPQL**
- JPA Criteria
- **QueryDSL**
- ë„¤ì´í‹°ë¸Œ SQL
- JDBC API ì§ì ‘ ì‚¬ìš©, MyBatis, SpringJdbcTemplate í•¨ê»˜ ì‚¬ìš©





## 02. JPQL ì†Œê°œ

- ê°€ì¥ ë‹¨ìˆœí•œ ì¡°íšŒ ë°©ë²•
  - `EntityManager.find()`
  - ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ (`a.getB().getC()`)
- ë‚˜ì´ê°€ 18ì‚´ ì´ìƒì¸ íšŒì›ì„ ëª¨ë‘ ê²€ìƒ‰í•˜ê³  ì‹¶ë‹¤ë©´?



## 03. JPQL

- JPA ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹° ê°ì²´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê°œë°œ
- ë¬¸ì œëŠ” ê²€ìƒ‰ ì¿¼ë¦¬
- ê²€ìƒ‰ì„ í•  ë•Œë„ **í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰**
- ëª¨ë“  DB ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ë³€í™˜í•´ì„œ ê²€ìƒ‰í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥
- ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í•„ìš”í•œ ë°ì´í„°ë§Œ DBì—ì„œ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ ê²°êµ­ ê²€ìƒ‰ ì¡°ê±´ì´ í¬í•¨ëœ SQLì´ í•„ìš”



- JPAëŠ” SQLì„ ì¶”ìƒí™”í•œ JPQL ì´ë¼ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ ì œê³µ
- SQLê³¼ ë¬¸ë²• ìœ ì‚¬, SELECT, FROM, WHERE, GROUP BY, HAVING, JOIN ì§€ì›
- JPQLì€ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬
- SQLì€ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬



- í…Œì´ë¸”ì´ ì•„ë‹Œ ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬
- SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤. SQLì— ì˜ì¡´ X
- JPQLì„ í•œë§ˆë””ë¡œ ì •ì˜í•˜ë©´ ê°ì²´ ì§€í–¥ SQL



```java
public class JpaMain {
  
  public static void main(String[] args) {
    EntityManagerFactory emf = Persistence.createEntityManagerFactory();
    EntityManager em = emf.createEntityManager();
    
    EntityTransaction tx = em.getTransaction();
    tx.begin();
    
    try {
      List<Member> result = em.createQuery(
        "select m from Member m where m.username like '%kim%'",
        Member.class
      ).getResultList();
      
    } catch (Exception e) {
      tx.rollback();
      
    } finally {
      em.close();
    }
  }
}
```



```java
// ê²€ìƒ‰
String jpql = "SELECT m FROM Member m WHERE m.name like '%hello%'";

List<Member> result = em.createQuery(jpql, Member.class)
  .getResultList();
```



## 04. Criteria ì†Œê°œ

- ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ
- JPQL ë¹Œë” ì—­í• 
- JPA ê³µì‹ ê¸°ëŠ¥
- **ë‹¨ì  : ë„ˆë¬´ ë³µì¡í•˜ê³  ì‹¤ìš©ì„±ì´ ì—†ë‹¤.**
- Criteria ëŒ€ì‹ ì— **QueryDSL ì‚¬ìš© ê¶Œì¥**



## 05. QueryDSL ì†Œê°œ

- ë¬¸ìê°€ ì•„ë‹Œ ìë°” ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ
- JPQL ë¹Œë” ì—­í• 
- ì»´íŒŒì¼ ì‹œì ì— ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŒ
- ë™ì ì¿¼ë¦¬ ì‘ì„± í¸ë¦¬í•¨
- ë‹¨ìˆœí•˜ê³  ì‰¬ì›€
- **ì‹¤ë¬´ ì‚¬ìš© ê¶Œì¥**

```java
// JPQL
// SELECT m FROM Member m WHERE m.age > 18

JPAFactoryQuery query = new JPAQueryFactory(em);
QMember m = QMember.member;

List<Member> list = query.selectFrom(m)
    .where(m.age.gt(18))
    .orderBy(m.name.desc())
    .fetch();


```



















