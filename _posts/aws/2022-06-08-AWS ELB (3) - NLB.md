---
layout: single

header:
  teaser: /assets/images/logo/aws.png
  overlay_image: /assets/images/logo/aws.png
  overlay_filter: linear-gradient(rgba(255, 0, 0, 0.5), rgba(0, 255, 255, 0.5))
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
  actions:
    - label: "Github"
      url: "https://github.com/renine94"

title: "[aws] EC2 ELB - NLB"
excerpt: "🚀 Network Load Balancer"

categories: aws
tag: [aws, elb, nlb]

toc: true
toc_label: "📕 목차"
toc_icon: "null"
toc_sticky: true

sidebar:
  nav: "docs"

---

# Network Load Balancer

> - Layer 4 에서 동작하는 네트워크 계층 로드 밸런서
> - TCP/UDP 기반의 트래픽을 인스턴스로 전달
> - 낮은 계층의 밸런서
> - 초당 수백만 건의 요청을 처리할 수 있어 매우 고성능
> - ALB 보다 지연시간이 훨씬 짧다.
>   - ALB 평균 400ms
>   - NLB 평균 100ms



- NLB 는 다른점이 많은데, 외부의 가용 영역(AZ) 당 1개의 고정 IP를 노출하기 때문
- 특정 IP를 화이트리스트에 추가할 때 유용
- NLB 자체의 IP를 가져오는 대신 탄력적(elastic) IP 할당을 지원
  - 엔트리포인트 2개를 얻고자 할 때 NLB 사용하면 된다.
- 애플리케이션 전용의 특정 IP를 지정하면, NLB가 해당 트래픽을 EC2 인스턴스로 보낸다.
  - 이것이 ALB, CLB 와의 차이점이다.
  - 위의 두 로드 밸런서는 고정IP 가 없고 고정 호스트 이름이 있습니다.



**사용사례**

- 고성능이나 TCP/UDP 수준의 트래픽을 원할때 사용한다.
- NLB 는 프리티어에 포함되지 않아서, 실습을 하려면 메모리 비용을 지불해야 한다.
- NLB가 L4 레이어 라는 것은 대상 그룹이 이전처럼 EC2 인스턴스가 될 수 있다는 의미
- 지금은 TCP 기반의 트래픽이 대상 그룹에 도달할 것이므로 외부에서 올 수 있으며, 대상그룹으로 리다이렉션 하는 일부 규칙도 있다.



NLB 는 무엇을 트래픽에 보낼까요?

- 여러 대상 그룹
  - EC2 인스턴스 : 대상그룹에 EC2 등록하면 NLB에서 트래픽 전송 방법을 파악
  - IP 주소 : 고정IP와 개인IP 지정해서 NLB에서 직접 트래픽을 보내도록 합니다.
    - EC2 인스턴스는 자체 데이터센터에 서버가 있는 경우에는 가급적 그대로 개인 IP가 있는 서버의 로드밸런서를 사용
  - ALB : NLB 와 ALB 를 결합하는 것이 가능
    - NLB 의 기능을 활용하여 고정 IP 를 가질 수 있다.
    - NLB 수준의 고정 IP를 가지면서 규칙과 같은 HTTP 관련 기능에 ALB를 활용할 수 있다.

